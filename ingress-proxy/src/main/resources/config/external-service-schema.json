{
  "$schema" : "http://json-schema.org/draft-07/schema#",
  "type" : "object",
  "required" : [ "enabled", "proxyHost", "proxyPort", "connectTimeout", "timeout", "enableHttp2", "maxConnectionRetries", "pathHostMappings", "urlRewriteRules", "pathPrefixes", "metricsInjection", "metricsName", "verifyHostname" ],
  "properties" : {
    "enabled" : {
      "type" : "boolean",
      "description" : "Indicate if the handler is enabled or not",
      "default" : false
    },
    "proxyHost" : {
      "type" : "string",
      "description" : "Proxy Host if calling within the corp network with a gateway like Mcafee gateway."
    },
    "proxyPort" : {
      "type" : "integer",
      "description" : "Proxy Port if proxy host is used. default value will be 443 which means HTTPS.",
      "format" : "int32"
    },
    "connectTimeout" : {
      "type" : "integer",
      "description" : "Connect Timeout in milliseconds. It is used to overwrite the connectTimeout in the client.yml. The default\nvalue is 3000.\n",
      "default" : 3000,
      "format" : "int32"
    },
    "timeout" : {
      "type" : "integer",
      "description" : "Timeout in milliseconds. It is used to overwrite the timeout in the client.yml. The default value is 5000.",
      "default" : 5000,
      "format" : "int32"
    },
    "enableHttp2" : {
      "type" : "boolean",
      "description" : "If HTTP2 is used to connect to the external service.",
      "default" : false
    },
    "maxConnectionRetries" : {
      "type" : "integer",
      "description" : "Max Connection Retries",
      "default" : 3,
      "format" : "int32"
    },
    "pathHostMappings" : {
      "type" : "array",
      "description" : "A list of request path to the service host mappings. Other requests will skip this handler. The value is\na string with two parts. The first part is the path and the second is the target host the request is\nfinally routed to.\n",
      "items" : {
        "type" : "string"
      }
    },
    "urlRewriteRules" : {
      "type" : "array",
      "description" : "URL rewrite rules, each line will have two parts: the regex pattern and replace string separated\nwith a space. For details, please refer to the light-router router.yml configuration.\nTest your rules at https://www.freeformatter.com/java-regex-tester.html\n",
      "items" : {
        "type" : "string"
      }
    },
    "pathPrefixes" : {
      "type" : "array",
      "description" : "Define path prefix related configuration properties as a list of key/value pairs. Make sure that there is\na pathPrefix key in the config along with timeout for request/response exchange timeout in milliseconds and\nhost for target host of the external API. If request path cannot match to one of the pathPrefixes, the request\nwill be skipped.\nNote that this config properties will replace the pathHostMappings which is for single purpose only.\n  - pathPrefix: /sharepoint\n    timeout: 2000\n    host: https://sharepoint.microsoft.com\n  - pathPrefix: /v1/petstore\n    timeout: 4000\n    host: https://petstore.example.com\n",
      "items" : {
        "type" : "object",
        "properties" : {
          "pathPrefix" : {
            "type" : "string",
            "pattern" : "^/.*"
          },
          "host" : {
            "type" : "string"
          },
          "timeout" : {
            "type" : "integer",
            "format" : "int32"
          }
        }
      }
    },
    "metricsInjection" : {
      "type" : "boolean",
      "description" : "When ExternalServiceHandler is used in the http-sidecar or light-gateway, it can collect the metrics info for\nthe total response time of the downstream API. With this value injected, users can quickly determine how much\ntime the http-sidecar or light-gateway handlers spend and how much time the downstream API spends, including\nthe network latency. By default, it is false, and metrics will not be collected and injected into the metrics\nhandler configured in the request/response chain.\n",
      "default" : false
    },
    "metricsName" : {
      "type" : "string",
      "description" : "When the metrics info is injected into the metrics handler, we need to pass a metric name to it so that the\nmetrics info can be categorized in a tree structure under the name. By default, it is external-response, and\nusers can change it.\n",
      "default" : "external-response"
    },
    "verifyHostname" : {
      "type" : "boolean",
      "description" : "Indicate if the hostname verification is enabled or not",
      "default" : true
    }
  }
}